<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Getting Started - Agentic Functional Programming in Rust</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="A pedagogical guide inspired by the Red Book and Rust resources.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="chapter_1_agentic_foundations.html">Agentic Introduction</a></li><li class="chapter-item expanded affix "><a href="chapter_2_getting_started.html" class="active">Getting Started</a></li><li class="chapter-item expanded affix "><a href="chapter_3_functional_data_structures.html">Functional Data Structures</a></li><li class="chapter-item expanded affix "><a href="chapter_4_handling_errors.html">Handling Errors</a></li><li class="chapter-item expanded affix "><a href="chapter_5_strictness_and_laziness.html">Strictness and Laziness</a></li><li class="chapter-item expanded affix "><a href="chapter_6_purely_functional_state.html">Purely Functional State</a></li><li class="chapter-item expanded affix "><a href="chapter_7_purely_functional_parallelism.html">Purely Functional Parallelism</a></li><li class="chapter-item expanded affix "><a href="chapter_8_property_based_testing.html">Property-Based Testing</a></li><li class="chapter-item expanded affix "><a href="chapter_9_parser_combinators.html">Parser Combinators</a></li><li class="chapter-item expanded affix "><a href="chapter_10_monoids.html">Monoids</a></li><li class="chapter-item expanded affix "><a href="chapter_11_monads.html">Monads</a></li><li class="chapter-item expanded affix "><a href="chapter_12_applicative.html">Applicative and Traversable</a></li><li class="chapter-item expanded affix "><a href="chapter_13_effects.html">External Effects and I/O</a></li><li class="chapter-item expanded affix "><a href="chapter_14_local_effects.html">Local Effects and Mutable State</a></li><li class="chapter-item expanded affix "><a href="chapter_15_streaming.html">Stream Processing</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Agentic Functional Programming in Rust</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="chapter-2-getting-started-with-functional-programming-in-rust"><a class="header" href="#chapter-2-getting-started-with-functional-programming-in-rust">Chapter 2: Getting started with functional programming in Rust</a></h1>
<p>In this chapter, we’ll begin learning how to write programs in the Rust language just by combining pure functions (Deterministic Tools). This chapter is mainly intended for those readers who are new to Rust, to functional programming, or both.</p>
<h2 id="21-introducing-rust-an-example"><a class="header" href="#21-introducing-rust-an-example">2.1 Introducing Rust: an example</a></h2>
<p>The following is a complete program listing in Rust. Our goal is just to introduce the Rust language and its syntax.</p>
<pre><pre class="playground"><code class="language-rust">// A comment!
/* Another comment */
/// A documentation comment

pub mod my_module {
    /// Pure function to calculate remaining tokens in a context window
    pub fn remaining_context(used: i32, limit: i32) -&gt; i32 {
        let remaining = limit - used;
        if remaining &lt; 0 {
            0
        } else {
            remaining
        }
    }

    pub fn format_status(used: i32) -&gt; String {
        format!("Context used: {}, Remaining: {}", used, remaining_context(used, 8192))
    }

    pub fn main() {
        println!("{}", format_status(4000));
    }
}
<span class="boring">fn main() {
</span><span class="boring">    my_module::main();
</span><span class="boring">}</span></code></pre></pre>
<p>We declare a module <code>my_module</code>. This is simply to give our code a place to live. Rust code is organized into modules (<code>mod</code>) and creates (structs, enums).</p>
<p>The <code>remaining_context</code> function is a pure function that takes two integers and returns the remaining capacity. Note the absence of an explicit <code>return</code> keyword. The value returned from a function is simply whatever value results from evaluating the last expression in the block.</p>
<h2 id="22-running-our-program"><a class="header" href="#22-running-our-program">2.2 Running our program</a></h2>
<p>The simplest way to run this is using <code>cargo</code>. If this were in <code>src/main.rs</code>, you could run:</p>
<pre><code class="language-sh">cargo run
</code></pre>
<h2 id="23-higher-order-functions-passing-functions-to-functions"><a class="header" href="#23-higher-order-functions-passing-functions-to-functions">2.3 Higher-order functions: passing functions to functions</a></h2>
<p>Functions are values. They can be assigned to variables, stored in data structures, and passed as arguments to functions.</p>
<h3 id="231-a-short-detour-writing-loops-functionally"><a class="header" href="#231-a-short-detour-writing-loops-functionally">2.3.1 A short detour: writing loops functionally</a></h3>
<p>First, let’s write <code>retry_backoff</code> to calculate the wait time (in ms) for the <code>n</code>th retry of a failed API call (simple factorial-style growth for demonstration):</p>
<pre><pre class="playground"><code class="language-rust">fn retry_backoff(n: i32) -&gt; i32 {
    fn go(n: i32, acc: i32) -&gt; i32 {
        if n &lt;= 0 {
            acc
        } else {
            go(n - 1, n * acc)
        }
    }
    go(n, 1)
}
<span class="boring">fn main() {
</span><span class="boring">    assert_eq!(retry_backoff(5), 120);
</span><span class="boring">}</span></code></pre></pre>
<p>The way we write loops functionally, without mutating a loop variable, is with a recursive function. Rust supports recursion, though it does not guarantee <strong>tail call elimination</strong> (TCO) in the same way Scala or Scheme might. For deep recursion (like an infinite agent loop), Rust programmers often use <code>loop</code>, <code>while</code>, or iterators to avoid blowing the stack. However, for the sake of learning FP concepts, we will use recursion here.</p>
<h3 id="exercise-21"><a class="header" href="#exercise-21">Exercise 2.1</a></h3>
<p>Write a recursive function to simulate a simplified Fibonacci-style token generation curve. The 0th and 1st steps produce 0 and 1 tokens respectively. The <code>n</code>th step produces the sum of the previous two.</p>
<pre><pre class="playground"><code class="language-rust">pub fn token_simulation(n: u32) -&gt; u32 {
    fn go(n: u32, prev: u32, curr: u32) -&gt; u32 {
        if n == 0 {
            prev
        } else {
            go(n - 1, curr, prev + curr)
        }
    }
    go(n, 0, 1)
}
<span class="boring">fn main() {
</span><span class="boring">    assert_eq!(token_simulation(0), 0);
</span><span class="boring">    assert_eq!(token_simulation(1), 1);
</span><span class="boring">    assert_eq!(token_simulation(5), 5);
</span><span class="boring">    assert_eq!(token_simulation(6), 8);
</span><span class="boring">}</span></code></pre></pre>
<h3 id="232-writing-our-first-higher-order-function"><a class="header" href="#232-writing-our-first-higher-order-function">2.3.2 Writing our first higher-order function</a></h3>
<p>We can generalize <code>format_status</code> and <code>format_backoff</code> to a single function <code>format_metric</code>:</p>
<pre><pre class="playground"><code class="language-rust">fn format_metric(name: &amp;str, n: i32, f: fn(i32) -&gt; i32) -&gt; String {
    format!("The {} for input {} is {}.", name, n, f(n))
}
<span class="boring">fn main() {
</span><span class="boring">    fn double(x: i32) -&gt; i32 { x * 2 }
</span><span class="boring">    println!("{}", format_metric("doubling", 21, double));
</span><span class="boring">}</span></code></pre></pre>
<p><code>f</code> is a function pointer or closure trait. Here we use <code>fn(i32) -&gt; i32</code>, which is a function pointer.</p>
<h2 id="24-polymorphic-functions-abstracting-over-types"><a class="header" href="#24-polymorphic-functions-abstracting-over-types">2.4 Polymorphic functions: abstracting over types</a></h2>
<p>We can write functions that work for any type.</p>
<h3 id="241-an-example-of-a-polymorphic-function"><a class="header" href="#241-an-example-of-a-polymorphic-function">2.4.1 An example of a polymorphic function</a></h3>
<p>Finding the first relevant Tool Call in a list of messages:</p>
<pre><pre class="playground"><code class="language-rust">fn find_first_tool&lt;A, F&gt;(items: &amp;[A], predicate: F) -&gt; Option&lt;usize&gt; 
where F: Fn(&amp;A) -&gt; bool {
    let mut n = 0;
    while n &lt; items.len() {
        if predicate(&amp;items[n]) {
            return Some(n);
        }
        n += 1;
    }
    None
}
<span class="boring">fn main() {
</span><span class="boring">    let tools = vec!["search", "calculator", "weather"];
</span><span class="boring">    assert_eq!(find_first_tool(&amp;tools, |x| *x == "calculator"), Some(1));
</span><span class="boring">}</span></code></pre></pre>
<p>Here, <code>A</code> is a generic type parameter. <code>F</code> is a generic type bounded by the <code>Fn</code> trait.</p>
<h3 id="exercise-22"><a class="header" href="#exercise-22">Exercise 2.2</a></h3>
<p>Implement <code>is_chronological</code>, which checks whether a slice of <code>Message</code>s <code>&amp;[A]</code> is sorted according to a given comparison function (e.g., timestamps).</p>
<pre><pre class="playground"><code class="language-rust">pub fn is_chronological&lt;A, F&gt;(messages: &amp;[A], ordered: F) -&gt; bool 
where F: Fn(&amp;A, &amp;A) -&gt; bool {
    let mut n = 0;
    while n + 1 &lt; messages.len() {
        if !ordered(&amp;messages[n], &amp;messages[n+1]) {
            return false;
        }
        n += 1;
    }
    true
}
<span class="boring">fn main() {
</span><span class="boring">    assert!(is_chronological(&amp;[1, 2, 3], |a, b| a &lt;= b));
</span><span class="boring">    assert!(!is_chronological(&amp;[1, 3, 2], |a, b| a &lt;= b));
</span><span class="boring">}</span></code></pre></pre>
<h2 id="25-following-types-to-implementations"><a class="header" href="#25-following-types-to-implementations">2.5 Following types to implementations</a></h2>
<h3 id="exercise-23-currying"><a class="header" href="#exercise-23-currying">Exercise 2.3 (Currying)</a></h3>
<p>Currying converts a function <code>f</code> of two arguments (e.g., a function taking <code>(SystemPrompt, UserQuery)</code>) into a function of one argument that partially applies the first (e.g., returns a function waiting for <code>UserQuery</code> with <code>SystemPrompt</code> baked in).</p>
<pre><pre class="playground"><code class="language-rust">pub fn curry&lt;A, B, C, F&gt;(f: F) -&gt; impl Fn(A) -&gt; Box&lt;dyn Fn(B) -&gt; C&gt;
where
    A: 'static + Clone,
    B: 'static,
    C: 'static,
    F: Fn(A, B) -&gt; C + 'static + Clone,
{
    move |a: A| {
        let f = f.clone();
        Box::new(move |b: B| f(a.clone(), b))
    }
}
<span class="boring">fn main() {
</span><span class="boring">    let add = |a, b| a + b;
</span><span class="boring">    let curried_add = curry(add);
</span><span class="boring">    let add_5 = curried_add(5);
</span><span class="boring">    assert_eq!(add_5(3), 8);
</span><span class="boring">}</span></code></pre></pre>
<p><em>Note: This strictly follows the type signature but requires allocation (<code>Box</code>) and cloning to satisfy the borrow checker for arbitrary <code>A</code>, <code>B</code>. In idiomatic Rust, we rarely "curry" manually, but the concept stands.</em></p>
<h3 id="exercise-24-uncurry"><a class="header" href="#exercise-24-uncurry">Exercise 2.4 (Uncurry)</a></h3>
<pre><pre class="playground"><code class="language-rust">pub fn uncurry&lt;A, B, C, F&gt;(f: F) -&gt; impl Fn(A, B) -&gt; C
where
    F: Fn(A) -&gt; Box&lt;dyn Fn(B) -&gt; C&gt; + 'static,
{
    move |a: A, b: B| {
        let g = f(a);
        g(b)
    }
}
<span class="boring">fn main() {} // Usage requires curry to be useful test</span></code></pre></pre>
<h3 id="exercise-25-compose"><a class="header" href="#exercise-25-compose">Exercise 2.5 (Compose)</a></h3>
<p>Implement the higher-order function that composes two functions (e.g., compose <code>extract_json</code> and <code>execute_tool</code>).</p>
<pre><pre class="playground"><code class="language-rust">pub fn compose&lt;A, B, C, F, G&gt;(f: F, g: G) -&gt; impl Fn(A) -&gt; C
where
    F: Fn(B) -&gt; C + 'static,
    G: Fn(A) -&gt; B + 'static,
    A: 'static,
{
    move |a: A| f(g(a))
}
<span class="boring">fn main() {
</span><span class="boring">   let f = |x| x + 1;
</span><span class="boring">   let g = |x| x * 2;
</span><span class="boring">   let h = compose(f, g);
</span><span class="boring">   assert_eq!(h(5), 11);
</span><span class="boring">}</span></code></pre></pre>
<h2 id="26-summary"><a class="header" href="#26-summary">2.6 Summary</a></h2>
<p>We introduced Rust syntax, recursion, higher-order functions (Combined Tools), and polymorphism.</p>
<h2 id="27-references"><a class="header" href="#27-references">2.7 References</a></h2>
<ul>
<li><strong>Functions</strong>: <a href="https://doc.rust-lang.org/book/ch03-03-how-functions-work.html">The Rust Book Ch 3.3</a></li>
<li><strong>Generics (<code>&lt;T&gt;</code>)</strong>: <a href="https://doc.rust-lang.org/book/ch10-01-syntax.html">The Rust Book Ch 10.1</a></li>
<li><strong>Trait Bounds (<code>where F: Fn</code>)</strong>: <a href="https://doc.rust-lang.org/book/ch10-02-traits.html">The Rust Book Ch 10.2</a></li>
<li><strong>Closures &amp; Iterators</strong>: <a href="https://doc.rust-lang.org/book/ch13-00-functional-features.html">The Rust Book Ch 13</a></li>
<li><strong>Rust By Example (Functions)</strong>: <a href="https://doc.rust-lang.org/rust-by-example/fn.html">Functions</a></li>
<li><strong>Rust By Example (Closures)</strong>: <a href="https://doc.rust-lang.org/rust-by-example/fn/closures.html">Closures</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="chapter_1_agentic_foundations.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="chapter_3_functional_data_structures.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="chapter_1_agentic_foundations.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="chapter_3_functional_data_structures.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
